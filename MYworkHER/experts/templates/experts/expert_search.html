{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>전문가 검색하기</title>
    {% comment %} <link rel="stylesheet" href="{% static 'css/expert.css' %}" /> {% endcomment %}
    <link rel="stylesheet" href="{% static 'components/footer.css' %}" />
    <link rel="stylesheet" href="{% static 'components/navbar.css' %}" />
</head>
<body>
{% include 'components/navbar.html' %}

<div class="wrapper">

  <div>
      <strong>지역</strong><br>
      {% for region in region_list %}
        <label>
          <input type="checkbox" name="region" value="{{ region }}" {% if region in selected_region %}checked{% endif %}>
          {{ region }}
        </label>
      {% endfor %}
    </div>

    <div>
      <strong>경력</strong><br>
      <label><input type="checkbox" name="experience" value="0" {% if '0' in selected_experience %}checked{% endif %}> 1년 미만</label>
      <label><input type="checkbox" name="experience" value="1" {% if '1' in selected_experience %}checked{% endif %}> 1년~3년</label>
      <label><input type="checkbox" name="experience" value="3" {% if '3' in selected_experience %}checked{% endif %}> 3년~5년</label>
      <label><input type="checkbox" name="experience" value="5" {% if '5' in selected_experience %}checked{% endif %}> 5년 이상</label>
    </div>

    <div>
      <label>
        <input type="checkbox" name="badge" value="true" {% if badge %}checked{% endif %}>
        인증배지 보유
      </label>
    </div>
  </form>

  <script>
    document.querySelectorAll('#expert-filter-form input[type="checkbox"]').forEach(function(checkbox) {
      checkbox.addEventListener('change', function() {
        document.getElementById('expert-filter-form').submit();
      });
    });
  </script>

  <hr>

  {% if experts %}
    <h3>검색 결과 (총 {{ total_count }}명)</h3>
    <ul>
    {% for expert in experts %}
      <li>
        <a href="{% url 'experts:expert_detail' expert.user.id %}">
          {{ expert.user.nickname }}{% if expert.badge == 'VERIFIED' %} ✔️{% endif %}
        </a><br>
        {{ expert.bio }}<br>
        {{ expert.description|truncatechars:100 }}
      </li>
    {% endfor %}
    </ul>

    {% if not show_all %}
    <form method="get">
      <input type="hidden" name="keyword" value="{{ keyword }}">
      {% for region in selected_region %}
        <input type="hidden" name="region" value="{{ region }}">
      {% endfor %}
      {% for e in selected_experience %}
        <input type="hidden" name="experience" value="{{ e }}">
      {% endfor %}
      {% if badge %}
        <input type="hidden" name="badge" value="true">
      {% endif %}
      <input type="hidden" name="show_all" value="true">
      <button type="submit">전체 보기</button>
    </form>
    {% endif %}
  {% elif keyword or selected_region or selected_experience or badge %}
    <p>검색 결과가 없습니다.</p>
  {% endif %}

  {% if not keyword and not selected_region and not selected_experience and not badge %}
  <hr>

</body>
</html>
