{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>전문가 리스트</title>
  <link rel="stylesheet" href="{%static 'css/category_expert.css'%}">
</head>
<body>
  <div class="Container">
      <!--Header-->
      <div class="Header">
        <div class="LeftGroup">
          <div class="Logo">
            <a href="{% url 'matching:main' %}">
              <img src="{% static 'img/logo.svg' %}" alt="logo" width="136px" />
            </a>
          </div>
          <div class="T_Category">
            <a href="{% url 'experts:category_list' %}" class="T_Category"
              >카테고리</a
            >
          </div>
          <div class="T_Search">
            <a href="{% url 'experts:expert' %}" class="T_Search">전문가찾기</a>
          </div>
          {% if request.user.is_authenticated%}
          <div class="T_Chat">
            <a href="{% url 'chats:chat_list'%}">1:1상담</a>
            {% if unread_chat_total > 0 %}
            <div class="Alarm"></div>
            {%endif%}
          </div>
          <div class="T_Mypage">
            <a href="{% url 'accounts:mypage' %}">마이페이지</a>
          </div>
        </div>
        <div class="Logout">
          <a href="{% url 'accounts:logout' %}">로그아웃</a>
        </div>
        {%else%}
        <button class="Btn" id="loginSection" style="display: none">
          <a href="{% url 'accounts:login'%}">로그인/회원가입</a>
        </button>
        {% endif %}
      </div>
      <div class="Category">
        <a href="{% url 'experts:expert' %}?category=appliance" class="C1 {% if request.GET.category != 'appliance' %}faded{% endif %}">
          <img
            src="{% static 'img/main_C1.svg' %}"
            alt="repair"
            width="222.516px"
          />
        </a>
         <a href="{% url 'experts:expert' %}?category=health" class="C2 {% if request.GET.category != 'health' %}faded{% endif %}">
          <img
            src="{% static 'img/main_C2.svg' %}"
            alt="sports"
            width="222.516px"
          />
        </a>
       <a href="{% url 'experts:expert' %}?category=business" class="C3 {% if request.GET.category != 'business' %}faded{% endif %}">
          <img
            src="{% static 'img/main_C3.svg'%}"
            alt="consulting"
            width="222.516px"
          />
        </a>
       <a href="{% url 'experts:expert' %}?category=lifestyle" class="C4 {% if request.GET.category != 'lifestyle' %}faded{% endif %}">
          <img
            src="{% static 'img/main_C4.svg'%}"
            alt="life"
            width="222.516px"
          />
        </a>
      </div>
      <div class="Line"></div>
  

  <form id="expert-filter-form" method="get" class="ResultFilter">
    <input type="hidden" name="category" value="{{ request.GET.category }}">
    <input type="hidden" name="subcategory" value="{{ request.GET.subcategory }}">

    <div class="ResultFilter">
      <div>
        <span class="BlueText">{{ category_label }}</span>
        <span class="BlackText"> > </span>
        <span class="BlueText">{{ subcategory_label }}</span>
        <span class="BlackText"> 에 해당하는</span> 
        <span class="BlueText">{{ total_count }}</span>
        <span class="BlackText"> 명의 전문가가 있습니다.</span>
      </div>

      <button class="Region">
        지역
        <img
          src="{% static 'img/filter.svg'%}"
          alt="filter"
          width="12.6px"
        />
      </button>
      <div class="Regioncheck">
        <div class="RegionTop">
          <label class="custom-checkbox">
            <input class="checkbox" type="checkbox" id="checkAll" name="region" value="all">
              {% if 'all' in selected_region %}checked{% endif %}
            <span class="checkmark"></span>
            <span class="checkbox-label">서울시 전체</span>
          </label>
        </div>
        <div class="RegionLine"></div>
        <div class="RegionGrid">
          {% for region in region_list %}
            <label class="custom-checkbox">
              <input class="checkbox" type="checkbox" name="region" value="{{ region }}" {% if region in selected_region %}checked{% endif %}>
            <span class="checkmark"></span>
            <span class="checkbox-label">{{region}}</span>
            </label>
      {% endfor %}
      </div>
    </div>
    

    
      <button class="Work">
        경력
        <img
          src="{% static 'img/filter.svg'%}"
          alt="filter"
          width="12.6px"
        />
      </button>
      <div class="WorkCheck">
        <div class="WorkTop">
          <label class="custom-checkbox">
            <input class="checkbox" type="checkbox" name="experience" value="0"
               {% if '0' in selected_experience %}checked{% endif %}>
            <span class="checkmark"></span>
            <span class="checkbox-label">경력 무관</span>
          </label>
        </div>
        <div class="WorkLine"></div>

        {% for val, label in [('0', '1년 미만'), ('1', '1년~3년'), ('3', '3년~5년'), ('5', '5년 이상')] %}
          <label class="custom-checkbox">
            <input class="checkbox" type="checkbox" name="experience" value="{{ val }}"
              {% if val in selected_experience %}checked{% endif %}>
            <span class="checkmark"></span>
            <span class="checkbox-label">{{ label }}</span>
          </label>
        {% endfor %}
      </div>

  

    
      <button class="Badge">
        인증배지
        <img
          src="{% static 'img/filter.svg'%}"
          alt="filter"
          width="12.6px"
        />
      </button>
      <div class="BadgeCheck">
        <div class="BadgeTop">
          <label class="custom-checkbox">
            <input class="checkbox" type="checkbox" name="badge" value="all"
              {% if not badge %}checked{% endif %}>
            <span class="checkmark"></span>
            <span class="checkbox-label">전체</span>
          </label>
        </div>
        <div class="BadgeLine"></div>

        <label class="custom-checkbox">
          <input class="checkbox" type="checkbox" name="badge" value="true"
            {% if badge %}checked{% endif %}>
          <span class="checkmark"></span>
          <span class="checkbox-label">인증배지 보유</span>
        </label>
      </div>
    </div>
  </form>

  <script>
    document.querySelectorAll('#expert-filter-form input[type="checkbox"]').forEach(function(checkbox) {
      checkbox.addEventListener('change', function() {
        document.getElementById('expert-filter-form').submit();
      });
    });
  </script>

  <!-- 전문가 카드 리스트 -->
  <div class="ExpertBoxes">
    {% for expert in experts %}
      <a href="{% url 'experts:expert_detail' expert.id %}" class="ExpertBox">
        <img 
          src="{% static 'img/profile.svg' %}"
          alt = "profile"
          width="74px"
          class="img"
        />
        <div class="ExpertInfo">
          <div class="NicknameDiv">
            <div class="Nickname">{{ expert.user.nickname }}</div>
        {% if expert.badge == 'VERIFIED' %}
          <img class="BadgeIcon"
           src="{% static 'img/badgeicon.svg' %}"
           alt="badge"
           width="33px"
          >
        {% endif %}
      </div>
      <div class="Introduce">
        {{ expert.bio }}
      </div>
      <div class="Description">
        {{ expert.description|truncatechars:100 }}
      </div>
    </div>
  </a>
  {% empty %}
    <p>해당 카테고리에 등록된 전문가가 없습니다.</p>
  {% endfor %}
  </div>

  <!-- 전체보기 버튼 (예시용) -->
  <button class="ShowAllBtn">
    <span class="Count">{{ total_count }}</span>
    <span class="ShowText"> 개의 결과 전체보기</span>
  </button>

  <footer class="Footer">
      <div class="Workher">
        <div class="B_Text">MY workHER 마이워커</div>
        <div class="S_Text">"당신을 위한 여성 전문가"</div>
        <div class="S_Text">
          마이워커는 가전/수리, 헬스/스포츠, 컨설팅/비지니스 등 다양한 분야에서
          여성 고객과 여성 전문가의 커넥션을 지원하며,
        </div>
        <div class="S_Text">
          여성 가치 증진을 목적으로 하는 혁신 플랫폼입니다.
        </div>
      </div>
      <div class="L_Line"></div>
      <div class="About">
        <div class="B_Text">About us</div>
        <div class="S_Text">
          PM/DE 김민서 - 숙명여자대학교 멋쟁이 사자처럼 기획/디자인
        </div>
        <div class="S_Text">
          FE 신채영 - 동덕여자대학교 멋쟁이사자처럼 프론트엔드
        </div>
        <div class="S_Text">
          FE 정규은 - 서울여자대학교 멋쟁이사자처럼 프론트엔드
        </div>
        <div class="S_Text">
          BE 고희주 - 덕성여자대학교 멋쟁이사자처럼 백엔드
        </div>
        <div class="S_Text">
          BE 고원정 - 성신여자대학교 멋쟁이사자처럼 백엔드
        </div>
      </div>
    </footer>
    <script src="{% static 'js/category_expert.js'%}"></script>
</body>
</html>
